{"version":3,"sources":["webpack:///webpack/bootstrap 3513138fd74bf93e4fdd","webpack:///external \"mongoose\"","webpack:///external \"express\"","webpack:///./server/models/post.js","webpack:///./server/models/category.js","webpack:///./server/index.js","webpack:///external \"nuxt\"","webpack:///external \"body-parser\"","webpack:///external \"express-session\"","webpack:///external \"connect-mongo\"","webpack:///./server/api/index.js","webpack:///./server/api/post.js","webpack:///./server/api/category.js","webpack:///./server/api/user.js","webpack:///./server/models/user.js","webpack:///external \"crypto\"","webpack:///./server/api/comment.js","webpack:///./server/models/comment.js","webpack:///./nuxt.config.js"],"names":["mongoose","require","Schema","PostSchema","title","type","String","required","content","brief","tag","category","Types","ObjectId","ref","published","Boolean","default","comments","Mixed","meta","votes","Number","ips","year","Date","getFullYear","created","Post","module","exports","model","CategorySchema","name","slug","Category","MongoStore","env","app","express","host","process","HOST","port","PORT","dbUrl","db","connect","connection","on","error","console","log","set","use","bodyParser","json","urlencoded","extended","session","secret","resave","saveUninitialized","cookie","maxAge","store","mongooseConnection","config","dev","nuxt","builder","build","render","listen","router","Router","get","req","res","next","sortby","query","sortdir","parseInt","indexOf","sortObj","conditions","trim","page","pageSize","skip","find","sort","populate","exec","err","posts","status","msg","message","results","slice","currentPage","totalPage","Math","ceil","length","obj","forEach","item","tep","Object","keys","includes","push","count","params","findOne","post","id","findOneAndUpdate","$inc","hasPost","send","remove","_id","body","meg","doc","newPost","save","err1","code","categories","toLowerCase","User","username","password","authUser","ok","user","oldp","newp","crypto","UserSchema","email","role","pre","sha","createHash","update","digest","methods","comparePwd","cb","d","Comment","comment","hasCommentId","findById","reply","to","newdoc","reply_text","from","newComment","commentData","start","CommentSchema","createAt","now","head","charset","hid","link","rel","href","css","vendor","extend","ctx","isClient","rules","enforce","test","loader","exclude","plugins","src","ssr"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3513138fd74bf93e4fdd","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","// Post model\nvar mongoose = require('mongoose'),\n    Schema = mongoose.Schema;\n\nvar PostSchema = new Schema({\n    title: { type: String, required: true },\n    content: { type: String, required: true },\n    // 摘要 到文章详情的时候需要 URL + 2015/06/20 + brief\n    brief: { type: String, required: true },\n    //是文章的标签，关键词 ,按标签查找文章的时候需要\n    tag: [],\n    category: { type: Schema.Types.ObjectId, ref: 'Category' },\n    published: { type: Boolean, default: false },\n    comments: [ Schema.Types.Mixed ],\n    meta: {\n      votes: Number, // 点赞次数\n      ips:  Number //: 浏览次数\n    },\n    year: {type: Number, default:new Date().getFullYear() },\n    created: { type: Date, default: new Date }\n});\n\nconst Post = module.exports =  mongoose.model('Post', PostSchema);\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/post.js","// Category model\n\nvar mongoose = require('mongoose'),\n    Schema = mongoose.Schema;\n\nvar CategorySchema = new Schema({\n    name: { type: String, required: true },\n    slug: { type: String, required: true },\n    created: { type: Date, default: new Date }\n});\n\nconst Category = module.exports = mongoose.model('Category', CategorySchema);\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/category.js","import express from 'express'\nimport { Nuxt, Builder } from 'nuxt'\nimport bodyParser from 'body-parser'\nimport session from 'express-session'\nconst MongoStore = require('connect-mongo')(session); // session连接mongoose\n// const mongoose = require('mongoose')\nimport mongoose from 'mongoose'\nimport api from './api'\nconst env = process.env.NODE_ENV || 'development'\n\nconst app = express()\nconst host = process.env.HOST || '0.0.0.0'\nconst port = process.env.PORT || 3000\n\nlet dbUrl = \"mongodb://47.104.98.140:27017/nuxt_blog\"\nif (env === \"development\") {\n  dbUrl = \"mongodb://localhost:27017/nuxt_blog\"\n}\n// 数据库设置\nconst db = mongoose.connect(dbUrl);\n// const db = mongoose.connect(\"mongodb://localhost:27017/nuxt_blog\");\n// 数据库连接\ndb.connection.on(\"error\", function(error) {\n  console.log(\"数据库连接失败：\" + error);\n});\ndb.connection.on(\"open\", function() {\n  console.log(\"------数据库连接成功！------\", dbUrl);\n});\n\napp.set('host', '47.104.98.140');\nif (env === \"development\") {\n  app.set('host', '127.0.0.1');\n}\napp.set('port', port)\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n      extended: true\n}));\n// Sessions 来创建 req.session\napp.use(session({\n  secret: 'super-secret-key',\n  resave: false,\n  saveUninitialized: false,\n  cookie: { maxAge: 60000 * 60 * 24 }, // 一天\n  store: new MongoStore({mongooseConnection: db.connection})\n}))\n\n// Import API Routes\napp.use('/api', api)\n\n// Import and Set Nuxt.js options\nlet config = require('../nuxt.config.js')\nconfig.dev = !(process.env.NODE_ENV === 'production')\n\n// Init Nuxt.js\nconst nuxt = new Nuxt(config)\n\n// Build only in dev mode\nif (config.dev) {\n  const builder = new Builder(nuxt)\n  builder.build()\n}\n\n// Give nuxt middleware to express\napp.use(nuxt.render)\n\n// Listen the server\napp.listen(port, host)\nconsole.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 8\n// module chunks = 0","import { Router } from 'express'\n\nimport post from './post'\nimport category from './category'\nimport user from './user'\nimport comment from './comment'\n\nconst router = Router()\n\n\n// Add USERS Routes\nrouter.use(post)\nrouter.use(category)\nrouter.use(user)\nrouter.use(comment)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/index.js","import { Router } from 'express';\nconst router = Router();\nconst mongoose = require('mongoose');\nconst Post = require('../models/post');\nconst Category = require('../models/category');\n\n// 获取全部文c\nrouter.get('/posts', function(req, res, next){\n    let sortby = req.query.sortby ? req.query.sortby : 'created';\n    let sortdir = req.query.sortdir ? parseInt(req.query.sortdir) : -1; // -1是降序\n\n    if (['meta.votes', 'meta.ips', 'title', 'category', 'author', 'created', 'published'].indexOf(sortby) === -1) {\n        sortby = 'created';\n    }\n    // if (['desc', 'asc'].indexOf(sortdir) === -1) {\n    //     sortdir = -1;\n    // }\n\n    let sortObj = {};\n    sortObj[sortby] = sortdir;\n    // condition\n    let conditions = {};\n    if (req.query.category) {\n        conditions.category = req.query.category.trim();\n    }\n    let page = +req.query.page || 0;\n    let pageSize = +req.query.pageSize;\n    let skip = 0\n    if (page && pageSize) {\n      skip = (page - 1) * pageSize;//跳过多少条\n    }\n    // 年份归档\n    let year = req.query.year\n\n    Post.find(conditions)\n            .sort(sortObj)\n            .populate('category')\n            // .skip(skip).limit(pageSize)\n            .exec(function (err, posts) {\n              if(err){\n                res.json({\n                  status: 0,\n                  msg: err.message\n                });\n              }else{\n                if (page && pageSize) {\n                  let results = posts.slice(skip, skip + pageSize);\n                  res.json({\n                    status: 1,\n                    currentPage: page,\n                    totalPage: Math.ceil(posts.length /pageSize),\n                    posts:results\n                  });\n                }else if (year === 'all'){\n                  // 处理找到的posts\n                  let obj = {};\n                  posts.forEach((item) => {\n                    let tep = item.year + \"\";\n                    if (Object.keys(obj).includes(tep)){\n                      obj[item.year].push(item);\n                    }else{\n                      obj[item.year] = [];\n                    }\n                  });\n                  res.json({\n                    status: 1,\n                    posts: obj,\n                    msg:'查找文档年份成功'\n                  });\n                }else{\n                  res.json({\n                    status: 1,\n                    count: posts.length,\n                    posts:posts, \n                    msg:'搜索文档成功'\n                  });\n                }\n\n              }//else\n            });\n});\n\n// 根据标签获取文章\nrouter.get('/posts/:tag', function(req, res, next){\n  Post.find({ tag: req.params.tag })\n            .populate('category')\n            .exec(function (err, posts) {\n              if(err){\n                res.json({\n                  status: 0,\n                  msg: err.message\n                });\n              }else{\n                res.json({\n                  status: 1,\n                  count: posts.length,\n                  posts:posts\n                });\n              }\n    });\n});\n\n// 按日期获取最近的十片文章\n// router.get('/posts/recently', function(req, res, next){\n//   let count = 10;\n//     Post.find({}).limit(count)\n//         .exec(function(err,posts){\n//           if(err){\n//             res.json({\n//               status: 0,\n//               msg: err.message\n//             })\n//           }else{\n//             res.json({\n//               status: 1,\n//               count: posts.length,\n//               posts:posts\n//             });\n//           }\n//       }); \n// });\n\n// 按标签关键词 slug 找所有文章\nrouter.get('/posts/:slug', function(req, res, next){\n    let conditions = {};\n    conditions.slug = req.params.slug;\n\n    Post.find(conditions, function(err, posts){\n      if(err){\n        res.json({\n          status:0,\n          msg:err.message\n        });\n      }else{\n        res.json({\n          status:1,\n          count:posts.length,\n          posts:posts\n        });\n      }\n    });\n});\n//一篇文章详情\nrouter.get('/posts/detail/:brief', function(req, res, next){\n  let brief = req.params.brief;\n  Post.findOne({ brief: brief })\n      .populate('category')\n      .exec(function(err, post){\n        if(err) {\n          res.json({\n\n          });\n        }else{\n          res.json({\n            status: 1,\n            post: post\n          });\n        }\n      });\n}); \n\n// 更新浏览次数\nrouter.get('/posts/detail_id/:id', function(req, res, next){\n  let id = req.params.id;\n  Post.findOneAndUpdate({ \"_id\":id }, {$inc :\n            {'meta.ips' : 1\n            }})\n            .populate('category')\n            .exec(function(err, hasPost){\n           if(err) {\n               res.status(500).send(err);\n           } else {\n              res.json({\n                status: 1,\n                post: hasPost,\n                msg: '浏览次数增加成功'\n              });\n           }\n        });\n}); \n// 删除一篇文章 admin \nrouter.post('/posts/delete/', function(req, res, next){\n  Post.remove({ _id: req.body.id }).exec(function (err, post) {\n        if (err) {\n          return res.json({\n            status: 0,\n            meg: err.message\n          })\n        }\n        if (post) {\n            res.json({\n              status: 1,\n              msg: post\n            });\n        } else {\n            res.json({\n              status: 1,\n              msg: \"文章删除失败\"\n            });\n        }\n    });\n});\n\n// 添加文章\nrouter.post('/add-post', function(req, res, next){\n  let params = req.body;\n  // 需要修改的\n  Category.findOne({name:params.category}, function(err,doc){\n    if(err) {\n      res.json({\n        status: 0,\n        meg: err.message\n      });\n    }else{\n      if(params.id) {// 文章已有，需要修改\n        Post.findOneAndUpdate({ \"_id\": params.id }, { \"$set\": \n          { \"title\": params.title, \n            \"content\": params.content, \n            \"brief\": params.brief, \n            \"tag\": params.tag,\n            \"category\": doc._id,\n          }}).exec(function(err, hasPost){\n           if(err) {\n               res.status(500).send(err);\n           } else {\n              res.json({\n                status: 1,\n                post: hasPost,\n                msg: '文章修改成功'\n              });\n           }\n        });\n        //\n      }else{\n        let newPost = new Post({\n          title: params.title,\n          content: params.content,\n          brief:params.brief,\n          tag:params.tag,\n          category:doc._id,\n          published: true,\n          comments: [],\n          meta:{\n            votes: 0,\n            ips: 0\n          },\n          created: new Date()\n        });\n        newPost.save(function (err1, post) {\n          // 注意，当Scheme字段定义必填的时候，如果前台没有填写完成，也会返回错误，但是整体请求是成功的\n          // 此处的err不是指的是前端请求的成功与否，而是指的是数据库操作的相关错误\n          if (err1) {\n            res.json({\n              status: 0,\n              code: 500,\n              msg: '请重新尝试'\n            });\n          }else{\n            res.json({\n              status: 1,\n              msg: '添加文章成功'\n            });\n          }\n        });\n      }\n    }\n  });\n  \n});\n\n// 增加点赞 \nrouter.get('/add-vote/:id', function(req, res, next){\n  let id = req.params.id;\n    Post.findOneAndUpdate({ \"_id\":id }, {$inc :\n            {'meta.votes' : 1\n            }})\n            .populate('category')\n            .exec(function(err, hasPost){\n           if(err) {\n               res.status(500).send(err);\n           } else {\n              res.json({\n                status: 1,\n                // post: hasPost,\n                msg: '点赞成功'\n              });\n           }\n        });\n});\n\n\n\n\n\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/post.js","import { Router } from 'express';\nconst router = Router();\nconst mongoose = require('mongoose');\nconst Post = require('../models/post');\nconst Category = require('../models/category');\n\n// 获取全部分类\nrouter.get('/categories', function(req, res, next){\n  Category.find({}, function(err, categories){\n    if(err) {\n      res.json({\n        status: 0,\n        msg: err.message\n      });\n    }else{\n      res.json({\n        status: 1,\n        count: categories.length,\n        categories: categories\n      });\n    }\n  });\n});\n\n// 添加分类\nrouter.post('/add-category', function(req, res, next){\n  let {name} = req.body;\n  let slug = name.toLowerCase();\n  let category = new Category({\n    name,\n    slug\n  });\n  category.save(function (err, category) {\n    if (err) {\n      res.json({\n        status: 0,\n        code: 500,\n        msg: \"请稍后重试\"\n      });\n    }else{\n      res.json({\n        status: 1,\n        msg: '添加分类成功'\n      });\n      // res.sendStatus(200);\n    }\n  });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/category.js","import { Router } from 'express';\nconst router = Router();\nconst mongoose = require('mongoose');\nconst Post = require('../models/post');\nconst Category = require('../models/category');\nconst User = require('../models/user');\n\n// 管理用户登录\nrouter.post('/user/login', (req, res) => {\n  if (req.body.username === 'admin' && req.body.password === 'admin11') {\n    req.session.authUser = { username: 'admin' }\n    return res.json({ username: 'admin' })\n  }\n  res.status(401).json({ message: '您没有权限访问此页面' })\n})\n\n// 管理用户登出\nrouter.post('/user/logout', (req, res) => {\n  delete req.session.authUser\n  res.json({ ok: true })\n})\n\n// router.post('/', function(req, res, next) {  \n//   var _user = new User(req.body.data);\n//   User.findOne({name: _user.name}, function (err, user_a) {\n//     if (err) res.json(err.status|| 500, {\"errorMsg\":err.message});\n//       user_a.comparePwd(_user.password,function(err_b,isMatch){\n//         if(err) res.json(err_b.message||500, {\"errorMsg\":err_b.message})\n//         else if(isMatch){\n//           req.session.user_session= user_a;\n//           res.json({\"data\":{\"name\":user_a.name,\"_id\":user_a._id}})\n//         }\n//         else  res.json(500, {\"errorMsg\": \"用户名或密码错误\"})\n//       })\n\n//   })\n// });\n\n// 查找用户\nrouter.get('/user/:id', function(req, res, next){\n  let id = req.params.id;\n  User.findOne({_id:id}, function(err, user){\n    if(err){\n      res.json({\n        status: 0,\n        code: 500,\n        msg: \"请稍后重试\"\n      });\n    }else {\n      res.json({\n        status: 1,\n        user:user,\n        msg: '查找用户成功'\n      });\n    }\n  });\n});\n\n// 后台账户密码修改\nrouter.post('/user/update-password', function(req, res, next){\n  let {oldp, newp} = req.body;\n  let name = 'admin'\n  User.findOne({name: name}, function(err, user){\n    if(err){\n      console.log(err)\n    }\n    if (user.password === oldp) {\n      user.password = newp;\n      user.save(function(err, user){\n        res.json({\n          status: 1,\n          msg: '成功修改密码'\n        })\n      })\n    }\n  });\n});\n// 添加用户\nrouter.post('/add-user', function(req, res, next){\n  let {name} = req.body;\n  let {password} = req.body;\n  let user = new User({\n    name,\n    password\n  });\n  user.save(function (err, user) {\n    if (err) {\n      res.json({\n        status: 0,\n        code: 500,\n        msg: \"请稍后重试\"\n      });\n    }else{\n      res.json({\n        status: 1,\n        user:user,\n        msg: '添加用户成功'\n      });\n    }\n  });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/user.js","var mongoose = require('mongoose'),\n    Schema = mongoose.Schema;\n\nvar crypto = require('crypto')\n\nvar UserSchema = new Schema({\n    name: { type: String, required: true },\n    email: { type: String},\n    role: { type: Number, default: 0},\n    password: { type: String, required: true },\n    created: { type: Date, default: new Date} \n});\n\nUserSchema.pre(\"save\",function (next) {  \n    var content = this.password + \"xiao\";\n    var sha = crypto.createHash('sha512WithRSAEncryption');\n    sha.update(content);\n    this.password = sha.digest('hex');\n    next();\n})\n\nUserSchema.methods = {  \n    comparePwd: function (password, cb) {\n        var sha = crypto.createHash('sha512WithRSAEncryption');\n        sha.update(password + \"xiao\");\n        var d = sha.digest('hex');\n        cb(null, d == this.password);\n    }\n};\n\n\nconst User = module.exports = mongoose.model('User', UserSchema);\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/user.js","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 14\n// module chunks = 0","import { Router } from 'express';\nconst router = Router();\nconst mongoose = require('mongoose');\nconst Post = require('../models/post');\nconst Category = require('../models/category');\nconst Comment = require('../models/comment');\n\n// 获取 一篇文章的所有评论\nrouter.get('/get-comment/:id', function(req, res, next){\n  let id = req.params.id\n    Comment.find({post:id})\n      .populate('from', 'name')\n      .populate('reply.to', 'name')\n      .exec(function(err, comments){\n        if(err) {\n          res.json({\n\n          });\n        }else{\n          res.json({\n            status: 1,\n            count: comments.length,\n            comments: comments\n          });\n        }\n      });\n});\n// 增加一条评论\nrouter.post('/add-comment', function(req, res, next){\n  let { comment, post ,user, hasCommentId } = req.body;\n  // flag 为true ,说明 是回复评论，不是发表评论\n  if(hasCommentId){\n    Comment.findById(hasCommentId)\n      .populate('from', 'name')\n      .populate('reply.to', 'name')\n      .exec(function(err, doc){\n        var reply = {\n          to: user._id,\n          content: comment\n        };\n        doc.reply.push(reply);\n        doc.save(function(err, newdoc){\n          if(err){\n            console.log(err);\n          }\n          res.json({\n            status: 1,\n            reply: true, \n            comment: newdoc,\n            reply_text: {\n              from: newdoc.from.name,\n              to: user.name,\n              content: comment\n            },\n            msg: '回复评论成功'\n          });\n          // res.redirect('/movie/' + movieId)\n        });\n      });\n  }else{\n    var newComment = {\n      post: post,\n      from: user._id,\n      content: comment\n    }\n    var commentData = new Comment(newComment);\n\n    commentData.save(function(err, doc){\n      if(err){\n        console.log(err);\n      }else {\n        res.json({\n          status: 1,\n          comment: doc,\n          from: user.name, \n          content: comment, \n          start: true, \n          msg: '评论添加成功'\n        });\n      }\n    })\n  }\n});\n\n// \n\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/api/comment.js","var mongoose = require('mongoose');\nvar Schema = mongoose.Schema;\nvar ObjectId = mongoose.Schema.Types.ObjectId;\n\nvar CommentSchema = new Schema({\n  post: {type: ObjectId, ref: 'Post'},\n  from: {type: ObjectId, ref: 'User'},\n  reply:[{\n    // from: {type: ObjectId, ref: 'User'},\n    to: {type: ObjectId, ref: 'User'},\n    content: String,\n    createAt:{ type:Date, default:Date.now()}\n  }],\n  content: String,\n  createAt:{\n    type:Date,\n    default:Date.now()\n  }\n});\n\n// CommentSchema.pre('save',function(next){\n//   var user = this;\n//   if(this.isNew){\n//     this.meta.createAt = this.meta.updateAt = Date.now();\n//   }else{\n//     this.meta.updateAt = Date.now();\n//   }\n//   next();\n// });\n\n\nconst Category = module.exports = mongoose.model('Comment', CommentSchema);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/comment.js","\nmodule.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'starter',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\n    ]\n  },\n  /*\n  ** Global CSS\n  */\n  css: ['~/assets/css/main.css', \n        '~/assets/css/font.css',\n        'quill/dist/quill.snow.css',\n        'quill/dist/quill.bubble.css',\n        'quill/dist/quill.core.css'\n        ],\n  /*\n  ** Add axios globally\n  */\n  build: {\n    vendor: ['axios'],\n    /*\n    ** Run ESLINT on save\n    */\n    extend (config, ctx) {\n      if (ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    }\n  },\n  plugins: [ \n    { src: '~plugins/nuxt-quill-plugin.js', ssr: false },\n    '~plugins/filters.js'\n  ],\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js"],"sourceRoot":""}